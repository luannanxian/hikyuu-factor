
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
<div itemprop="articleBody">
<section id="quickstart">
<span id="id1"></span><h1>新手入门<a class="headerlink" href="#quickstart" title="Permalink to this heading"></a></h1>
<section id="id2">
<h2>开始请先下载数据<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h2>
<p>pip 安装 Hikyuu 后，可在命令行终端中执行 hikyuutdx 命令，启动数据下载工具，并按界面提示下载数据：</p>
<figure class="align-default">
<img alt="_images/install-20190228.png" src="_images/install-20190228.png"/>
</figure>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如在命令行终端中无法执行 hikyuutdx 命令，请到 python 安装目录下的 Scripts （通常是安装python时没有将该路径放入系统 PATH 路径中）子目录中选择该执行文件（HikyuuTDX.exe）。如果还是不行，可以到 python/Lib/site-packages 下找到 hikyuu 的安装目录，在其下的 gui 目录中有 HikyuuTdx.py, 可以从命令行终端中直接执行 python HikyuuTdx.py 执行观察报错信息。</p>
</div>
<p>如不希望使用 GUI 图形界面下载，可在命令行终端中执行 importdata 命令，如下图所示：</p>
<figure class="align-default">
<img alt="_images/install-2019022802.png" src="_images/install-2019022802.png"/>
</figure>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由于 importdata 命令使用的是 HikyuuTDX 生成的配置文件，windows建议至少运行过一次 HikyuuTDX 进行配置（可以不执行导入，但配置后必须先退出），否则将使用默认配置。如果默认配置导入出错，可以自行修改用户目录下.hikyuu目录中的相应配置文件。</p>
</div>
</section>
<section id="id3">
<h2>通过代码示例学习<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h2>
<p>您可以从下面的网址访问最新的代码示例，这些示例将帮助您逐步了解和掌握 Hikyuu 的使用以及系统交易的相关理念。在日常使用 Hikyuu 的过程中，您可以在本帮助内查询相应的内建指标、策略、函数的详细说明，获得更多的信息。</p>
<p><a class="reference external" href="https://nbviewer.jupyter.org/github/fasiondog/hikyuu/blob/master/hikyuu/examples/notebook/000-Index.ipynb?flush_cache=True">https://nbviewer.jupyter.org/github/fasiondog/hikyuu/blob/master/hikyuu/examples/notebook/000-Index.ipynb?flush_cache=True</a></p>
<p>上述示例代码均使用 Jupyter notebook 编辑和运行，您可以从每个示例网址的右上角下载示例代码，并在 Jupyter notebook 中打开直接运行。</p>
<figure class="align-default">
<img alt="_images/quickstart_download.png" src="_images/quickstart_download.png"/>
</figure>
<p>或者从安装目录下的 “examples/notebook” 找到全部示例。</p>
<figure class="align-default">
<img alt="_images/quickstart_examples.png" src="_images/quickstart_examples.png"/>
</figure>
<p>如果不习惯使用 Jupyter notebook，也可以使用自己喜欢的 Python 客户端工具（如 shell、Spyder、PyCharm、idle等），按照示例代码进行学习运行。有关 Jupyter notebook 或 其它 Python 客户端使用，请参考后续章节。使用过程中，如遇到中文字符显示乱码、在 python shell 中绘图无法显示的情况，请参考后续章节。</p>
</section>
<section id="python-shell">
<h2>从 Python Shell 中运行<a class="headerlink" href="#python-shell" title="Permalink to this heading"></a></h2>
<p>您可以使用任意的 Python 客户端工具运行 Hikyuu。运行 Hikyuu。如下图所示，是在 cmd 中 Python shell 环境下运行 hikyuu。从上述示例中拷贝代码时，<strong>应注意将开头带有“%”的代码去除，如 “%time”，</strong> 这些是 ipython 的魔力代码，只在 ipython 环境中生效，普通的 shell 中没有。</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/quickstart_shell.png"><img alt="_images/quickstart_shell.png" src="_images/quickstart_shell.png" style="width: 700px;"/></a>
</figure>
<p>运行 Hikyuu 交互式工具，需在首先将其引入，代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#在交互式环境下使用hikyuu，首先需引入hikyuu交互工具</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hikyuu.interactive</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Hikyuu本身是普通的Python包，而 hikyuu.interactive 为 Hikyuu 包中包含的交互式工具。如希望基于 hikyuu 包开发自己的其他程序而不是作为交互式程序使用，可以参考 hikyuu/interactive/interactive.py 实现 hikyuu 的正常初始化。</p>
</div>
</section>
<section id="jupyter-notebook">
<h2>使用 Jupyter notebook 编辑和运行<a class="headerlink" href="#jupyter-notebook" title="Permalink to this heading"></a></h2>
<p>Jupyter notebook（此前被称为 IPython notebook）是一个基于web的交互式笔记本、编辑器及运行平台，支持运行 40 多种编程语言，已成为科研探索类工作的主要编程和分享工具。有关 Jupyter notebook 的更多信息，请进行网络搜索。</p>
<p>启动 Jupyter notebook，只需要在 cmd 中，进入自己希望的工作目录后，键入 Jupyter notebook 命令即可，如下图所示：</p>
<figure class="align-default">
<img alt="_images/quickstart_jupyter.png" src="_images/quickstart_jupyter.png"/>
</figure>
<p>上述命令，将启动本地的web服务，此时，您可以打开浏览器（建议使用Chrome或Firefox浏览器），输入如下地址：<a class="reference external" href="http://127.0.0.1:8888/tree">http://127.0.0.1:8888/tree</a> 即可根据其界面中的菜单命令象普通的代码编辑器一样编辑和运行代码。</p>
<figure class="align-default">
<img alt="_images/quickstart_jupyter2.png" src="_images/quickstart_jupyter2.png"/>
</figure>
</section>
<section id="id4">
<h2>利用 Jupyter notebook 搭建自己的云量化平台<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h2>
<p>搭建自己的云量化平台，首先需要拥有一个可以从公网访问的服务器，可以自行购买云服务器（如阿里云、腾讯云等）。之后需要对 Jupyter notebook 进行配置，使其能够远程进行访问，配置方法如下：</p>
<ol class="arabic simple">
<li><p>登陆远程服务器</p></li>
<li><p>生成配置文件，在 cmd 下，键入如下命令：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">notebook</span> <span class="o">--</span><span class="n">generate</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>生成密码，在 cmd 下键入 ipython 命令，创建一个密文的密码，把生成的密文‘sha:ce…’复制下来：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span><span class="w"> </span><span class="nn">jupyter_server.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">passwd</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">passwd</span><span class="p">()</span>
<span class="n">Enter</span> <span class="n">password</span><span class="p">:</span>
<span class="n">Verify</span> <span class="n">password</span><span class="p">:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="s1">'sha1:ce23d945972f:34769685a7ccd3d08c84a18c63968a41f1140274'</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>修改默认配置文件 “jupyter_notebook_config.py”，该文件位于windows登录用户路径下的 “.jupyter” 目录下，如下图所示。注意：windows下 .jupyter 是隐藏目录，需要将资源管理器设置为显示隐藏文件夹才能看见 “.jupyter” 目录，或直接在资源管理器的地址中输入路径：</p></li>
</ol>
<figure class="align-default">
<img alt="_images/quickstart_jupyter_config.png" src="_images/quickstart_jupyter_config.png"/>
</figure>
<p>进行如下修改：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">ip</span><span class="o">=</span><span class="s1">'0.0.0.0'</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">'sha:ce...刚才复制的那个密文'</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">open_browser</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span><span class="mi">8888</span> <span class="c1">#随便指定一个端口</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>启动jupyter notebook，在 cmd 下，进入自己希望的工作目录后，键入命令：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">notebook</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>为了方便起见，可以在桌面建立批处理文件，如希望工作目录为“d:\workspace\hikyuu\examples”，则可使用记事本输入下面的内容后，保存为“.bat”文件，之后可直接在桌面双击该文件，即可启动:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">:</span>
<span class="n">cd</span> \<span class="n">workspace</span>\<span class="n">hikyuu</span>\<span class="n">examples</span>
<span class="n">jupyter</span> <span class="n">notebook</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>在浏览器中，输入你的远程服务器地址，如 “<a class="reference external" href="http:/">http:/</a>/服务器地址:8888” 即可访问。如可以在手机浏览器中访问，并可直接通过手机对代码进行编辑并运行，如：</p></li>
</ol>
<figure class="align-default">
<img alt="_images/10003-phone.jpg" src="_images/10003-phone.jpg"/>
</figure>
</section>
<section id="matplotlib">
<h2>matplotlib显示图形时中文字体乱码的问题<a class="headerlink" href="#matplotlib" title="Permalink to this heading"></a></h2>
<p>通常 hikyuu 绘图已经默认支持中文，如果仍出现乱码，可参考此处，或百度。</p>
<p>需修改 matplotlib 配置文件，把字体改为支持中文的字体。matplotlib文件位于 python安装目录/matplotlib/mpl-data/matplotlibrc，可用任意文本编辑器打开编辑，文件位置如下图所示：</p>
<figure class="align-default">
<img alt="_images/quickstart_matplotlib_config.png" src="_images/quickstart_matplotlib_config.png"/>
</figure>
<ol class="arabic simple">
<li><p>在配置文件中找到下面一行：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#font.sans-serif     : DejaVu Sans, Bitstream Vera Sans, Lucida Grande, Verdana, Geneva, Lucid, Arial, Helvetica, Avant Garde, sans-serif</span>
</pre></div>
</div>
<p>注释去掉，在冒号后面添加 SimHei（如果使用 Ubuntu，可以使用 “Noto Sans CJK JP”），可以正常显示中文标签。</p>
<p>再把下面一行的注释去掉，把冒号后面改成False可以正常显示正负号。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#axes.unicode_minus  : True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>删除 “.matplotlib” 目录下的字体缓存文件 “fontList.py3k.cache”。（Ubuntu 下，该位置为用户目录 .cache/matplotlib，删除该目录下所有文件）</p></li>
<li><p>检查 “c:\windows\fons” 目录下，是否存在 simhei.ttf 文件，如果没有可从网上搜索下载或加入Hikyuu QQ群下载字体文件，将该字体文件拷贝至 “c:\windows\fons” 目录下。</p></li>
<li><p>经历以上步骤还是无法正常显示，请检查用户目录下是否也存在 matplotlib 的配置，如 Windows 中用户目录下的 .matplotlib（见下图示例）。此时可删除用户目录下的 .matplotlib 下的 matplotlibrc 文件，或者整个目录的内容删除。</p></li>
</ol>
<figure class="align-default">
<img alt="_images/quickstart_matplotlib_config2.jpg" src="_images/quickstart_matplotlib_config2.jpg"/>
</figure>
</section>
<section id="id5">
<h2>matplotlib无法自动绘制图像的问题<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h2>
<p>matplotlib 默认每次绘图后，都要调用 plt.show() 显示图形，这在交互式探索时，非常不方便，同样可以修改其配置文件，使其不必显示调用 plt.show() 即可显示图形。</p>
<p>参考上一章节，找到 matplotlib 配置文件，修改 “interactive” 选项，改为 True：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#interactive  : False</span>
<span class="n">interactive</span>  <span class="p">:</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="jupyter-matplotlib-ipywidgets">
<h2>在 jupyter 中使用 matplotlib ipywidgets 后端<a class="headerlink" href="#jupyter-matplotlib-ipywidgets" title="Permalink to this heading"></a></h2>
<p>默认的 matplotlib 绘图较慢且无法自由缩放，在 jupyter 环境中，可以使用 pip 安装 ipympl, 让 matplotlib 使用 web 方式绘图。</p>
<p>在 jupyter 中开头使用 %matplotlib widget 命令，即可使用 ipympl 绘图。</p>
<p>如果使用 ipympl 绘图时，出现 “Loading widgets …” 后，不显示图像，可能是依赖包版本不兼容，可尝试使用 pip 更新 jupyterlab, notebook, ipywidgets 包。</p>
</section>
<section id="ubuntu-wayland-qt">
<h2>Ubuntu wayland 平台上 QT 不可用<a class="headerlink" href="#ubuntu-wayland-qt" title="Permalink to this heading"></a></h2>
<p>使用 wayland 的 ubuntu, 可能需要设置 QT_QPA_PLATFORM=wayland 环境变量，通常可以在 .bashrc 中 添加 export QT_QPA_PLATFORM=wayland 进行设置</p>
</section>
<section id="pycharm-ide">
<h2>PyCharm 等 IDE 无法正常提示帮助信息<a class="headerlink" href="#pycharm-ide" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>安装 pybind11-stubgen，使用命令 pip install pybind11-stubgen</p></li>
<li><p>运行 pybind11-stubgen hikyuu 命令，即可正常提示帮助信息。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>2.3.1 版本开始，hikyuu 打包时已经默认生成 pyi 文件</p>
</div>
</section>
</section>
</div>
</body>
</html>
